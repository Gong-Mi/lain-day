### **序章待办功能清单 (Draft)**

#### 1. **完善核心时间系统**
这是所有动态事件的基础。
-   [x] **实现时间循环**：**[已完成]**
    -   **实现方式**: 底层时间计数器是一个 24 位的数据，它在一个约 12 天的周期后会通过无符号整数溢出自然实现“回绕”。
    -   **混淆机制**: `uint32_t` 中最高的 2 个比特位被时间逻辑有意地保留，不参与计算，作为随机“噪音”存在，旨在增加存档修改的难度。
    -   **上层逻辑**: 游戏中的条件判断 (`check_conditions`) 和时间显示 (`print_game_time`) 逻辑现在都基于这个约 12 天的周期工作。
-   [ ] **实现通用时间成本**：将时间消耗 (`time_cost`) 从单个动作中抽离，变为一个更通用的机制。可以考虑在 `actions.json` 的 action 定义中增加一个可选的 `time_cost` 字段，并在 `executor.c` 中统一处理。

#### 2. **实现一个“时间关联事件”**
这是为了验证“硬编码地图是为了配合时间系统”这一核心决策。
-   [ ] **创建动态 NPC/事件**：在 `map_loader.c` 硬编码的地点中，设置一个只在特定时间段内才会触发的事件或出现的NPC。例如：
    *   *“父亲只在 19:00 - 21:00 (1140-1260分钟) 之间才会出现在客厅看报纸。”*
-   [ ] **实现场景逻辑**：在 `render_current_scene` 或相关函数中，加入基于 `game_state->time_of_day` 的判断，来决定是否显示特定的描述或选项。

#### 3. **引入“CPU核心进阶”解谜玩法**
这是游戏最独特的玩法之一，序章必须引入这个概念。
-   [ ] **扩充玩家状态**：在 `game_types.h` 的 `PlayerState` 结构体中，加入 `cpu_features` 数组。
-   [ ] **实现 `unlock_feature` 动作**：在 `executor.c` 中，添加一个新的动作类型，用于向 `cpu_features` 数组中添加新特性（如 "int64", "fp32"）。
-   [ ] **设计一个简单谜题**：
    *   例如，让玩家接触一个需要 `int64` 才能正确读取的数字（例如一个密码）。
    *   当玩家的 CPU 只支持 `int32` 时，读取结果会是错误的（整数溢出）。
    *   玩家需要通过一个剧情动作（例如“让爸爸帮忙升级Navi”）来触发 `unlock_feature` 动作，解锁 `int64` 支持后，才能回来获得正确的密码。

#### 4. **引入“分层现实描述”叙事机制**
这是另一个核心叙事机制，能极大地提升游戏氛围。
-   [ ] **扩充地点数据**：在 `map_loader.c` 中，为您硬编码的地点（如 `lain_room`）增加 `description_wired` 字段。
-   [ ] **修改 `arls` 或 `look` 命令**：在 `executor.c` 中，修改 `arls` 或 `look` 命令的逻辑，使其能根据玩家的某个状态（例如一个新的 `wired_level` 状态）来选择显示 `description`（物理层）还是 `description_wired`（网络层）。
-   [ ] **创建状态切换动作**：设计一个游戏内动作，可以改变玩家的 `wired_level` 状态，让玩家能够亲身体验“世界”描述的变化。

#### 5. **清理与文档**
-   [x] **清理废弃资产**：删除已不再使用的 `old_map` 目录和 `actions.json.bak`，保持项目整洁。**[已完成主要死代码清理 (`story_parser.c/.h`)。]**
-   [ ] **撰写基础设置文档**：创建一个 `README.md` 文件，简要说明项目的编译方法和 `zlib` 等依赖的获取方式。

#### 6. **显示与对话系统优化**
-   [ ] **明确对话发言人机制**：当前 `print_colored_line` 通过字符串匹配来猜测发言人。优化为在 `StoryScene` 或 `StringID` 层面显式指定发言人，以实现更精确和灵活的对话显示。
