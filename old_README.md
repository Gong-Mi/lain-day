# Project: lain-day

## 项目目标 (Project Goal)

本作的核心目标是，在 `Gemini CLI` 环境下，合作完成一部具有中篇小说体量的、可交互的文本游戏。并在创作过程中，不断探索和确定其独特的游戏类型。

## 核心理念 (Core Concepts)

本项目旨在通过一个非线性的、深度分支的叙事体验，探索身份认同、现实与虚拟、记忆与“可能性”等核心主题。玩家的选择，甚至“不选择”，都将深刻地影响故事的走向和主角Lain对世界的认知。

## 主要特色 (Main Features)

*   **混合交互系统**: 融合了传统的 **选项驱动叙事** 和复古的 **终端命令行交互**。玩家既是故事的亲历者，也是通过终端观察和影响世界的“操作者”。
*   **数据驱动设计**: 游戏引擎与内容完全分离。故事、地图、物品和规则分别由 `story/`、`map/` 目录和 `.json` 文件定义，易于扩展和修改。
*   **环境扫描**: 独特的 `arls` 指令允许玩家以“增强现实”的视角扫描当前环境，发现隐藏的兴趣点和信息。

## 如何运行 (How to Run)

本项目使用纯Python标准库编写，无需安装任何依赖。

```bash
python game.py
```

**注意**: 每次重大更新（如修改了`character.json`的结构）后，建议在游戏提示时输入一个**全新的会话名称**来开始新游戏，以确保所有新功能正常工作。

## 项目结构 (Project Structure)

-   `game.py`: 游戏主引擎和入口。
-   `engine/`: 存放游戏的核心逻辑模块，如解析器、渲染器、终端等。
-   `story/`: 存放所有 `.md` 格式的故事脚本文件。
-   `map/`: 模块化的地图系统。每个子目录代表一个地点，包含该地点的描述、兴趣点和连接等信息。
-   `actions.json`: “动作”规则库，定义了玩家在故事中选择一个选项后会发生什么。
-   `character.json`: 角色状态文件，记录玩家的属性、位置、信用等级、物品栏等。
-   `items.json`: 物品数据库，定义了游戏中的所有物品及其属性。

## 当前进度 (Current Progress)

*   **引擎开发**: 游戏引擎已基本完成，支持场景渲染、故事解析、终端命令处理和多分支的游戏逻辑。
*   **核心系统实现**:
    *   **地点系统**: 已重构为由 `.md` 文件头部信息驱动的自动化系统。
    *   **地图系统**: 已重构为模块化的 `map/` 目录结构。
    *   **物品系统**: 支持数量统计，并实现了基于“信用等级”的获取机制。
*   **故事创作**: 序章及第一、二章的部分故事线已完成。

## 下一步计划 (Next Steps)

1.  **故事创作**: 继续填充剩余的“断头路” (`todo_*.md` 文件)，丰富故事分支。
2.  **引擎开发**: 实现 `use <物品>` 指令，让玩家可以使用物品栏中的物品来与环境或角色互动。
3.  **内容完善**: 为所有故事文件添加 `location` 头部信息，并简化 `actions.json` 中的动作定义。

## 未完成的功能点 (To-Do List)

根据我们最近的盘点，项目中还有以下功能点和剧情分支等待实现：

### 1. NAVI 内部未实现的功能 (NAVI Internal Features)

*   **[退出NAVI] (`shutdown_navi_placeholder`)**: 目前只会刷新菜单，可以为其添加一个真正的关机动画或特殊剧情。
*   **[声音设置] (`sound_settings_placeholder`)**: 声音设置界面还是空的，可以为其添加调整音量、音效等功能。
*   **[语言选项] (`language_options_disabled`)**: 显示设置中为灰色不可用状态，可以为其添加多语言切换功能。
*   **[参与讨论] (`join_chat_discussion`)**: 聊天室中的这个选项目前没有后续内容。

### 2. 指向 `todo_` 文件的未完成剧情分支 (Unfinished Story Branches)

这些是 `actions.json` 中定义的、但还没有对应具体故事内容的动作：

*   `dad_ask_upgrade`: 爸爸帮忙升级电脑的剧情。
*   `ch2_hug_alice_continue`: 第二章拥抱爱丽丝后的后续。
*   `ask_about_mika`: 询问关于美香（Mika）的剧情。
*   `reply_is_me`: 回复“是我”的剧情。
*   `alice_asks_about_lain_and_boss`: 爱丽丝询问 Lain 和酒吧老板的关系。
*   `lain_asks_what_sister_does`: Lain 询问姐姐的工作。
*   `boss_offers_free_service`: 酒吧老板提供免费服务。
*   `boss_invites_lain_to_sing`: 酒吧老板邀请 Lain 唱歌。
*   `lain_asks_about_server_location`: Lain 询问服务器的位置。
