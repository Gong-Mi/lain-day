# 游戏时间系统设计理念

## 核心原则

游戏的内部时间系统被设计为一个 **高精度、带错误纠正码 (ECC) 保护的绝对计数器**，旨在为未来的 **CPU模拟器** 和 **状态机模拟** 提供一个符合“Wired”世界计算机直觉的底层时钟。

## 技术实现细节

1.  **时间储存：**
    *   时间数据以 **24位无符号整数** 形式存储。
    *   时间精度为 **1/16秒**，即每秒钟有16个时间单位。
    *   这个24位数据与 **6位ECC校验码** 结合，总共封装在一个32位无符号整数 (`uint32_t`) 中。
    *   ECC采用 **SECDED (Single Error Correction, Double Error Detection)** 汉明码变体，能够自动纠正单比特错误，并检测双比特错误。

2.  **绝对时间流逝：**
    *   游戏时间以1/16秒为单位 **单调递增**。
    *   **没有设置游戏天数上限**。时间计数器会一直累加，直到达到24位数据位的最大值 (`2^24 - 1`)。
    *   达到上限后，计数器会发生 **自然溢出 (natural overflow)** 并归零。这个溢出被视为游戏世界的底层特性，符合“计算机的直觉”，而非程序错误。它在游戏内部大约每 **12.13天** 发生一次。

3.  **时间显示：**
    *   对外显示（如界面上的时间）将从绝对时间值中通过取模运算提取出当天的 **小时和分钟**，不会直接显示游戏进行了多少天。

4.  **错误处理与主题融合：**
    *   当加载存档时，会对时间数据进行ECC解码。
    *   如果检测到 **双比特错误（无法纠正的损坏）**，游戏将触发一个特殊的 **“时间故障”叙事场景**。
    *   即使是ECC纠正后的时间，也可能因更复杂的错误（如三比特错误）而显示出“荒唐”但符合“计算机直觉”的结果。

## 设计目的与游戏机制关联

1.  **CPU/状态机模拟基础：**
    *   高精度、无人工限制的绝对时间流逝，为精确模拟虚拟CPU的每个“时钟周期”或复杂状态机的每个离散状态提供了基础。

2.  **“时间倒流”机制的可能性：**
    *   游戏默认的启动时间设置为 **“第3天晚上8点”**。
    *   选择一个非零的起始时间（`3,916,800` 个1/16秒单位）为未来实现 **“时间倒流/回溯”** 的游戏机制预留了空间。玩家可以通过某些行为让时间往回倒退（通过从绝对时间计数器中减去数值）。
    *   “第3天”的起始点提供了足够的回溯“缓冲”，同时“倒流”的极限是绝对时间为0，不能再往前倒退，从而保证了机制的有限度。

3.  **主题深度：**
    *   时间溢出、ECC错误修正导致的“荒唐时间”以及时间倒流的可能性，都旨在深化《Serial Experiments Lain》中关于 **现实与虚拟界限模糊、数据完整性、系统深层逻辑** 的主题。玩家将体验到一个按照自己底层规则运行的“Wired”世界。
